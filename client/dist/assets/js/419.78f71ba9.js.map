{"version":3,"file":"assets/js/419.78f71ba9.js","mappings":"urBAyCMA,GAAiBC,EAAAA,EAAAA,KAAI,GAarBC,GAAaC,EAAAA,EAAAA,KAAS,KAC1B,OAAQC,EAAMC,YACZ,KAAK,IACH,MAAO,gBACT,KAAK,IACH,MAAO,gBACT,KAAK,IACH,MAAO,kBACT,KAAK,IACH,MAAO,eACT,KAAK,IACH,MAAO,eACT,QACE,MAAO,gBAAiB,IAGxBC,EAAOA,MACXC,EAAAA,EAAAA,KAAS,KACP,IAAIC,EAAeC,SAASC,cAAc,UACtCC,EAAgB,IAAIC,UAAUC,MAAML,GACxCG,EAAcL,OACdN,EAAec,OAAQ,CAAI,GAC3B,EAEEC,EAAaA,KACjB,IAAIP,EAAeC,SAASC,cAAc,UACtCC,EAAgB,IAAIC,UAAUC,MAAML,GACxCG,EAAcK,OACdhB,EAAec,OAAQ,CAAK,E,OAG9BG,EAAa,CAAEX,OAAMS,e,mXC/ErB,MAAMG,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,QCLA,SAASC,IACL,MAAMC,EAAYA,CAACC,EAAShB,KACxBiB,QAAQC,IAAI,6BAGZ,MAAMC,EAAaf,SAASgB,cAAc,OAC1ChB,SAASiB,KAAKC,YAAYH,GAG1B,MAAMI,GAAWC,EAAAA,EAAAA,IAAUhB,EAAO,CAAEQ,UAAShB,eACvCM,EAAgBiB,EAASE,MAAMN,GAErCF,QAAQC,IAAI,uBAGRZ,GAA+C,oBAAvBA,EAAcL,MACtCK,EAAcL,OAGlByB,YAAW,KACPH,EAASI,UACTvB,SAASiB,KAAKO,YAAYT,GAC1BF,QAAQC,IAAI,0BAA0B,GACvC,IAAM,EAGb,MAAO,CACHH,YAER,CAEA,QC7BAc,EAAAA,EAAAA,aAAAA,QAAAA,KACIC,IACQC,aAAaC,YACbF,EAAOG,QAAQC,cAAgBH,aAAaC,WAEzCF,KACRK,GACQC,QAAQC,OAAOF,KAK9BN,EAAAA,EAAAA,aAAAA,SAAAA,KACIS,IAEI,MAAM,UAAEvB,GAAcD,IAMtB,OAHIwB,EAASC,MAAQD,EAASC,KAAKvB,SAC/BD,EAAUuB,EAASC,KAAKvB,QAASsB,EAASE,QAEvCF,CAAQ,IAEnBG,UACI,MAAM,UAAE1B,GAAcD,IAEtB,GADAG,QAAQC,IAAI,kBAAmBiB,EAAMG,UACjCH,EAAMG,SAAU,CAChB,MAAM,OAAEE,EAAM,KAAED,GAASJ,EAAMG,SAGzBI,EAAeH,EAAKvB,SAAWuB,EAAKJ,OAAS,qBAGpC,MAAXK,GACAzB,EAAU,qCAAsCyB,EAAO,SACvDT,aAAaY,WAAW,aACxBC,EAAAA,EAAAA,KAAY,WAGZ7B,EAAU2B,EAAcF,EAEhC,MAEIzB,EAAU,mCAAoC,SAGlD,OAAOqB,QAAQC,OAAOF,EAAM,IAKpC,MAAeN,EAAK,C,qBCpDpBgB,EAAQ,EAAU,CAACC,EAAK/C,KACpB,MAAMgD,EAASD,EAAIE,WAAaF,EAChC,IAAK,MAAOG,EAAKC,KAAQnD,EACrBgD,EAAOE,GAAOC,EAElB,OAAOH,CAAM,C,+ICRVI,MAAM,mB,UACTC,EAAAA,EAAAA,GAEM,OAFDD,MAAM,eAAa,W,UAItBC,EAAAA,EAAAA,GAEM,OAFDD,MAAM,eAAa,EACtBC,EAAAA,EAAAA,GAAiC,MAA7BD,MAAM,cAAa,WAAK,K,GAEzBA,MAAM,a,GACJA,MAAM,Q,UACTC,EAAAA,EAAAA,GAAwD,SAAjDD,MAAM,uBAAsB,iBAAa,K,UAS9CC,EAAAA,EAAAA,GAEC,SAFMD,MAAM,aACV,kDAA8C,K,GAIhDA,MAAM,Q,UACTC,EAAAA,EAAAA,GAAmD,SAA5CD,MAAM,uBAAsB,YAAQ,K,UAQzCC,EAAAA,EAAAA,GAEQ,SAFDD,MAAM,aAAY,gDAEzB,K,GAIDA,MAAM,wB,UAEoBC,EAAAA,EAAAA,GAAkF,QAA5ED,MAAM,kDAAkD,iBAAa,K,0CAzC9GE,EAAAA,EAAAA,IAgDM,MAhDNC,EAgDM,CA/CJC,GAGAH,EAAAA,EAAAA,GA2CO,QA3CDD,MAAM,OAAQK,SAAMC,EAAA,KAAAA,EAAA,IAAAC,EAAAA,EAAAA,KAAAC,GAAUC,EAAAC,WAAO,e,CACzCC,GAGAV,EAAAA,EAAAA,GA8BM,MA9BNW,EA8BM,EA7BJX,EAAAA,EAAAA,GAcM,MAdNY,EAcM,CAbJC,GACAb,EAAAA,EAAAA,GAWM,sBAVJA,EAAAA,EAAAA,GAME,SALAc,KAAK,QACLf,MAAM,eACN,mBAAiB,YACjBgB,YAAY,c,qCACHC,EAAAC,UAAUC,MAAKX,I,iBAAfS,EAAAC,UAAUC,SAErBC,OAKJnB,EAAAA,EAAAA,GAaM,MAbNoB,EAaM,CAZJC,GACArB,EAAAA,EAAAA,GAUM,sBATJA,EAAAA,EAAAA,GAKE,SAJAc,KAAK,WACLf,MAAM,eACNgB,YAAY,W,qCACHC,EAAAC,UAAUK,SAAQf,I,iBAAlBS,EAAAC,UAAUK,YAErBC,SAMNvB,EAAAA,EAAAA,GAOM,MAPNwB,EAOM,EANJxB,EAAAA,EAAAA,GAEO,QAFDD,MAAM,cAAe0B,QAAKpB,EAAA,KAAAA,EAAA,GAAAE,GAAEC,EAAAkB,iB,UAAgB,gCACrBC,KAE7B3B,EAAAA,EAAAA,GAES,UAFDc,KAAK,SAASf,MAAM,kBAAmB6B,UAAOvB,EAAA,KAAAA,EAAA,GAAAE,GAAEC,EAAAC,YAAW,WAEnE,Y,iCASR,GACEoB,KAAM,WACNC,WAAY,CAAC,EACb3C,OACE,MAAO,CACL8B,UAAW,CACTY,KAAM,GACNX,MAAO,GACPI,SAAU,GACVS,SAAU,IAGhB,EACAC,QAAS,CACPvB,UACchC,EAAAA,EAAAA,KAAW,mBAAoBwD,KAAKhB,WAAWiB,MAAMC,IAC/DtE,QAAQC,IAAI,WAEZ,MAAM,MAAEsE,GAAUD,EAAIhD,KACtBR,aAAa0D,QAAQ,YAAaD,GAGlC,MAAME,GAAUC,EAAAA,EAAAA,GAAWH,GAC3BvE,QAAQC,IAAIsE,GAGZH,KAAKO,OAAOC,SAAS,oBAAqBR,KAAKS,QAAQJ,IACvDL,KAAKO,OAAOC,SAAS,UAAWH,GAEhCL,KAAKU,QAAQC,KAAK,CAAEC,KAAM,KAAM,GAEpC,EACAnB,eACEO,KAAKU,QAAQC,KAAK,CAACC,KAAK,aAC1B,EACAH,QAAQrF,GACN,YACYyF,IAAVzF,GACU,OAAVA,GACkB,kBAAVA,GAAoD,IAA9B0F,OAAOC,KAAK3F,GAAO4F,QAC/B,kBAAV5F,GAA8C,IAAxBA,EAAM6F,OAAOD,MAE/C,I,UC1FJ,MAAMxF,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS0F,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://client/./src/views/ToastComponent.vue","webpack://client/./src/views/ToastComponent.vue?3354","webpack://client/./src/composables/useToast.js","webpack://client/./src/http.js","webpack://client/./node_modules/vue-loader/dist/exportHelper.js","webpack://client/./src/views/Login.vue","webpack://client/./src/views/Login.vue?240b"],"sourcesContent":["<!-- MyToast.vue -->\n<template>\n  <div\n    aria-live=\"polite\"\n    aria-atomic=\"true\"\n    style=\"position: relative; min-height: 200px\"\n  >\n    <!-- Position it -->\n    <div style=\"position: absolute; top: 0; right: 0\">\n      <!-- Then put toasts within -->\n      <div\n        class=\"toast alert\"\n        :class=\"alertClass\"\n        role=\"alert\"\n        aria-live=\"assertive\"\n        aria-atomic=\"true\"\n      >\n        <div class=\"toast-header\">\n          <strong class=\"mr-auto\">{{ message }}</strong>\n          <small class=\"text-muted\">just now</small>\n          <button\n            type=\"button\"\n            class=\"ml-2 mb-1 close\"\n            data-dismiss=\"toast\"\n            @click=\"closeToast\"\n            aria-label=\"Close\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n        <!-- <div class=\"toast-body\">\n        See? Just like this.\n      </div> -->\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, defineProps, computed, nextTick } from \"vue\";\n\nconst isToastShowing = ref(false);\n\nconst props = defineProps({\n  message: {\n    type: String,\n    default: \"\",\n  },\n  statusCode: {\n    type: Number,\n    default: 200,\n  },\n});\n\nconst alertClass = computed(() => {\n  switch (props.statusCode) {\n    case 200:\n      return \"alert-success\";\n    case 400:\n      return \"alert-warning\"; // 或者你可以定义自己的灰色 alert 样式\n    case 403:\n      return \"alert-secondary\";\n    case 404:\n      return \"alert-danger\";\n    case 500:\n      return \"alert-danger\";\n    default:\n      return \"alert-primary\"; // 默认颜色\n  }\n});\nconst show = () => {\n  nextTick(() => {\n    let toastElement = document.querySelector(\".toast\");\n    let toastInstance = new bootstrap.Toast(toastElement);\n    toastInstance.show();\n    isToastShowing.value = true;\n  });\n};\nconst closeToast = () => {\n  let toastElement = document.querySelector(\".toast\");\n  let toastInstance = new bootstrap.Toast(toastElement);\n  toastInstance.hide();\n  isToastShowing.value = false;\n};\n\ndefineExpose({ show, closeToast });\n</script>\n\n<style scoped>\n.toast {\n  position: fixed;\n  top: 5%;\n  right: 5%;\n  z-index: 99999;\n  padding: 1rem;\n}\ndiv.toast.alert-success {\n  color: var(--bs-success-text);\n  background-color: var(--bs-success-bg-subtle);\n  border-color: var(--bs-success-border-subtle);\n}\ndiv.toast.alert-warning {\n  color: var(--bs-warning-text);\n  background-color: var(--bs-warning-bg-subtle);\n  border-color: var(--bs-warning-border-subtle);\n}\ndiv.toast.alert-secondary {\n  color: var(--bs-dark-text);\n  background-color: var(--bs-dark-bg-subtle);\n  border-color: var(--bs-dark-border-subtle);\n}\ndiv.toast.alert-danger {\n  color: var(--bs-danger-text);\n  background-color: var(--bs-danger-bg-subtle);\n  border-color: var(--bs-danger-border-subtle);\n}\n</style>","import script from \"./ToastComponent.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ToastComponent.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ToastComponent.vue?vue&type=style&index=0&id=9522ce64&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/jiandongz/Desktop/vue-partner-system/vue3-deploy/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9522ce64\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport Toast from '../views/ToastComponent.vue';\n\nfunction useToast() {\n    const showToast = (message, statusCode) => {\n        console.log(\"Inside showToast function\");\n\n        // 创建一个新的 div 元素作为挂载点\n        const mountPoint = document.createElement('div');\n        document.body.appendChild(mountPoint);\n\n        // 使用 createApp 创建一个新的 Vue app 实例，并将 Toast 组件挂载到 mountPoint 上\n        const toastApp = createApp(Toast, { message, statusCode }); // 注意这里增加了statusCode\n        const toastInstance = toastApp.mount(mountPoint);\n\n        console.log(\"Toast added to body\");\n\n        // 如果 Toast 组件有 show 方法，则调用它\n        if (toastInstance && typeof toastInstance.show === 'function') {\n            toastInstance.show();\n        }\n\n        setTimeout(() => {\n            toastApp.unmount(); // 使用 toastApp 卸载组件\n            document.body.removeChild(mountPoint);\n            console.log(\"Toast removed from body\");\n        }, 30000);  \n    };\n\n    return {\n        showToast\n    };\n}\n\nexport default useToast;","import axios from 'axios';\nimport router from './router'\nimport useToast from './composables/useToast'\n\n\naxios.interceptors.request.use(\n    config => {\n        if (localStorage.userToken) {\n            config.headers.Authorization = localStorage.userToken;\n        }\n        return config;\n    }, error => {\n        return Promise.reject(error)\n    }\n)\n\n\naxios.interceptors.response.use(\n    response => {\n        \n        const { showToast } = useToast();\n\n        // 判断是否存在 message 并显示 toast\n        if (response.data && response.data.message) {\n            showToast(response.data.message, response.status);\n        }\n        return response\n    },\n    async error => {\n        const { showToast } = useToast()\n        console.log(\"error response:\", error.response)\n        if (error.response) {\n            const { status, data } = error.response;\n\n            // 使用后端返回的 message 或默认信息\n            const errorMessage = data.message || data.error || 'An error occurred.';\n\n            // 为特定的状态码设置特殊处理\n            if (status === 401) {\n                showToast('Token invalid. Please login again.', status,'error');\n                localStorage.removeItem('userToken');\n                router.push('/login');\n            } else {\n                // 对于其他状态码，直接显示后端返回的错误信息\n                showToast(errorMessage, status);\n            }\n        } else {\n            // 如果没有 error.response，可能是网络问题或其他问题\n            showToast('Network error. Please try again.', 'error');\n        }\n\n        return Promise.reject(error);\n    }\n);\n\n\nexport default axios","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","<template>\n  <div class=\"col-md-12 login\">\n    <div class=\"login-image\">\n\n    </div>\n    <form class=\"card\" @submit.prevent=\"logUser()\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">Login</h3>\n      </div>\n      <div class=\"card-body\">\n        <div class=\"mb-3\">\n          <label class=\"form-label required\">Email address</label>\n          <div>\n            <input\n              type=\"email\"\n              class=\"form-control\"\n              aria-describedby=\"emailHelp\"\n              placeholder=\"Enter email\"\n              v-model=\"loginUser.email\"\n            />\n            <small class=\"form-hint\"\n              >We'll never share your email with anyone else.</small\n            >\n          </div>\n        </div>\n        <div class=\"mb-3\">\n          <label class=\"form-label required\">Password</label>\n          <div>\n            <input\n              type=\"password\"\n              class=\"form-control\"\n              placeholder=\"Password\"\n              v-model=\"loginUser.password\"\n            />\n            <small class=\"form-hint\">\n              Your password must be 8-20 characters long\n            </small>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer text-end\">\n        <span class=\"go_register\" @click=\"gotoRegister()\">\n          Does't have a account yet? <span class=\"p-1 text-primary-emphasis bs-primary-bg-subtle \">Register here</span> \n        </span>\n        <button type=\"submit\" class=\"btn btn-primary\" @onclick=\"logUser()\">\n          Submit\n        </button>\n      </div>\n    </form>\n  </div>\n</template>\n<script>\nimport axios from \"../http\";\nimport jwt_decode from \"jwt-decode\";\n\nexport default {\n  name: \"register\",\n  components: {},\n  data() {\n    return {\n      loginUser: {\n        name: \"\",\n        email: \"\",\n        password: \"\",\n        identity: \"\",\n      },\n    };\n  },\n  methods: {\n    logUser() {\n      const res = axios.post(\"/api/users/login\", this.loginUser).then((res) => {\n        console.log(\"success\");\n        //token\n        const { token } = res.data;\n        localStorage.setItem(\"userToken\", token);\n\n        //decode token\n        const decoded = jwt_decode(token);\n        console.log(token);\n\n        //store token into vuex\n        this.$store.dispatch(\"setAuthenticated\", !this.isEmpty(decoded));\n        this.$store.dispatch(\"setUser\", decoded);\n\n        this.$router.push({ path: \"/\" });\n      });\n    },\n    gotoRegister() {\n      this.$router.push({path:'/register'})\n    },\n    isEmpty(value) {\n      return (\n        value === undefined ||\n        value === null ||\n        (typeof value === \"object\" && Object.keys(value).length === 0) ||\n        (typeof value === \"string\" && value.trim().length === 0)\n      );\n    },\n  },\n};\n</script>\n\n<style scoped>\n.login {\n  display: flex;\n  justify-content: center;\n  align-items: stretch;\n  padding-top: 30px;\n  margin: 0 auto;\n  max-width: 960px;\n  max-height: 650px;\n  height: 100vh; /* Make sure the register form is centered vertically in the viewport */\n  background-color: #f0f2f5; /* This is an assumed background color as per the image */\n}\n.login .login-image {\n  flex: 3;\n  background: url('~@/assets/login-register.jpg') no-repeat center center;\n  background-size: cover;\n  min-height: 400px; /* 这里设置了一个最小高度 */\n  width: 100%; /* 设置宽度为100% */\n}\n\n\n.card {\n  flex:1.5;\n  width: 100%;\n  max-width: 400px; /* Adjust width as per design in image */\n  background: #fff;\n  border-radius: 8px;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Add some shadow to the card */\n}\n\n.card-header {\n  background-color: #f8f9fa;\n  border-bottom: 1px solid #e9ecef;\n  padding: 4px;\n}\n\n.card-title {\n  margin: 0;\n  font-size: 24px; /* Larger font size for the title */\n  font-weight: bold;\n}\n\n.card-body {\n  padding: 4px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.form-label {\n  margin-bottom: .15rem;\n  font-size: 16px;\n  color: #495057;\n}\n\n.form-control {\n  display: block;\n  width: 100%;\n  padding: .375rem .75rem;\n  font-size: 1rem;\n  font-weight: 400;\n  line-height: 1.5;\n  color: #495057;\n  background-color: #fff;\n  background-clip: padding-box;\n  border: 1px solid #ced4da;\n  border-radius: .25rem; /* Rounded borders for inputs */\n  transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;\n}\n\n.form-control:focus {\n  color: #495057;\n  background-color: #fff;\n  border-color: #80bdff;\n  outline: 0;\n  box-shadow: 0 0 0 .2rem rgba(0,123,255,.25);\n}\n\n.form-select {\n  display: block;\n  width: 100%;\n  padding: .375rem 1.75rem .375rem .75rem;\n  font-size: 1rem;\n  font-weight: 400;\n  line-height: 1.5;\n  color: #495057;\n  background-color: #fff;\n  border: 1px solid #ced4da;\n  border-radius: .25rem;\n  appearance: none;\n}\n\n.btn-primary {\n  color: #fff;\n  background-color: #007bff; /* Blue color for the button */\n  border-color: #007bff;\n  border-radius: .25rem;\n}\n\n.btn-primary:hover {\n  color: #fff;\n  background-color: #0069d9;\n  border-color: #0062cc;\n}\n\n.go_login {\n  display: block;\n  text-align: right;\n  margin-top: .5rem;\n}\n\n.text-primary-emphasis {\n  color: #007bff;\n  font-weight: bold;\n}\n\n.bs-primary-bg-subtle {\n  background-color: rgba(0, 123, 255, .1);\n  padding: .25rem .5rem;\n  border-radius: .25rem;\n}\n\n.card-footer {\n  background-color: #f8f9fa;\n  border-top: 1px solid #e9ecef;\n  padding: 4px;\n}\n</style>","import { render } from \"./Login.vue?vue&type=template&id=cc4cdd72&scoped=true\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport \"./Login.vue?vue&type=style&index=0&id=cc4cdd72&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/jiandongz/Desktop/vue-partner-system/vue3-deploy/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-cc4cdd72\"]])\n\nexport default __exports__"],"names":["isToastShowing","ref","alertClass","computed","props","statusCode","show","nextTick","toastElement","document","querySelector","toastInstance","bootstrap","Toast","value","closeToast","hide","expose","__exports__","useToast","showToast","message","console","log","mountPoint","createElement","body","appendChild","toastApp","createApp","mount","setTimeout","unmount","removeChild","axios","config","localStorage","userToken","headers","Authorization","error","Promise","reject","response","data","status","async","errorMessage","removeItem","router","exports","sfc","target","__vccOpts","key","val","class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","onSubmit","_cache","_withModifiers","$event","$options","logUser","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","type","placeholder","$data","loginUser","email","_hoisted_7","_hoisted_8","_hoisted_9","password","_hoisted_10","_hoisted_11","onClick","gotoRegister","_hoisted_12","onOnclick","name","components","identity","methods","this","then","res","token","setItem","decoded","jwt_decode","$store","dispatch","isEmpty","$router","push","path","undefined","Object","keys","length","trim","render"],"sourceRoot":""}