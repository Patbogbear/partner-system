{"version":3,"file":"assets/js/368.518f363c.js","mappings":"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","sources":["webpack://client/./src/views/ToastComponent.vue","webpack://client/./src/views/ToastComponent.vue?3354","webpack://client/./src/composables/useToast.js","webpack://client/./src/http.js","webpack://client/./node_modules/vue-loader/dist/exportHelper.js","webpack://client/./src/views/Personal.vue","webpack://client/./src/views/Personal.vue?da89"],"sourcesContent":["<!-- MyToast.vue -->\n<template>\n  <div\n    aria-live=\"polite\"\n    aria-atomic=\"true\"\n    style=\"position: relative; min-height: 200px\"\n  >\n    <!-- Position it -->\n    <div style=\"position: absolute; top: 0; right: 0\">\n      <!-- Then put toasts within -->\n      <div\n        class=\"toast alert\"\n        :class=\"alertClass\"\n        role=\"alert\"\n        aria-live=\"assertive\"\n        aria-atomic=\"true\"\n      >\n        <div class=\"toast-header\">\n          <strong class=\"mr-auto\">{{ message }}</strong>\n          <small class=\"text-muted\">just now</small>\n          <button\n            type=\"button\"\n            class=\"ml-2 mb-1 close\"\n            data-dismiss=\"toast\"\n            @click=\"closeToast\"\n            aria-label=\"Close\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n        <!-- <div class=\"toast-body\">\n        See? Just like this.\n      </div> -->\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, defineProps, computed, nextTick } from \"vue\";\n\nconst isToastShowing = ref(false);\n\nconst props = defineProps({\n  message: {\n    type: String,\n    default: \"\",\n  },\n  statusCode: {\n    type: Number,\n    default: 200,\n  },\n});\n\nconst alertClass = computed(() => {\n  switch (props.statusCode) {\n    case 200:\n      return \"alert-success\";\n    case 400:\n      return \"alert-warning\"; // 或者你可以定义自己的灰色 alert 样式\n    case 403:\n      return \"alert-secondary\";\n    case 404:\n      return \"alert-danger\";\n    case 500:\n      return \"alert-danger\";\n    default:\n      return \"alert-primary\"; // 默认颜色\n  }\n});\nconst show = () => {\n  nextTick(() => {\n    let toastElement = document.querySelector(\".toast\");\n    let toastInstance = new bootstrap.Toast(toastElement);\n    toastInstance.show();\n    isToastShowing.value = true;\n  });\n};\nconst closeToast = () => {\n  let toastElement = document.querySelector(\".toast\");\n  let toastInstance = new bootstrap.Toast(toastElement);\n  toastInstance.hide();\n  isToastShowing.value = false;\n};\n\ndefineExpose({ show, closeToast });\n</script>\n\n<style scoped>\n.toast {\n  position: fixed;\n  top: 5%;\n  right: 5%;\n  z-index: 99999;\n  padding: 1rem;\n}\ndiv.toast.alert-success {\n  color: var(--bs-success-text);\n  background-color: var(--bs-success-bg-subtle);\n  border-color: var(--bs-success-border-subtle);\n}\ndiv.toast.alert-warning {\n  color: var(--bs-warning-text);\n  background-color: var(--bs-warning-bg-subtle);\n  border-color: var(--bs-warning-border-subtle);\n}\ndiv.toast.alert-secondary {\n  color: var(--bs-dark-text);\n  background-color: var(--bs-dark-bg-subtle);\n  border-color: var(--bs-dark-border-subtle);\n}\ndiv.toast.alert-danger {\n  color: var(--bs-danger-text);\n  background-color: var(--bs-danger-bg-subtle);\n  border-color: var(--bs-danger-border-subtle);\n}\n</style>","import script from \"./ToastComponent.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ToastComponent.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ToastComponent.vue?vue&type=style&index=0&id=9522ce64&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/jiandongz/Desktop/vue-partner-system/vue3-deploy/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9522ce64\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport Toast from '../views/ToastComponent.vue';\n\nfunction useToast() {\n    const showToast = (message, statusCode) => {\n        console.log(\"Inside showToast function\");\n\n        // 创建一个新的 div 元素作为挂载点\n        const mountPoint = document.createElement('div');\n        document.body.appendChild(mountPoint);\n\n        // 使用 createApp 创建一个新的 Vue app 实例，并将 Toast 组件挂载到 mountPoint 上\n        const toastApp = createApp(Toast, { message, statusCode }); // 注意这里增加了statusCode\n        const toastInstance = toastApp.mount(mountPoint);\n\n        console.log(\"Toast added to body\");\n\n        // 如果 Toast 组件有 show 方法，则调用它\n        if (toastInstance && typeof toastInstance.show === 'function') {\n            toastInstance.show();\n        }\n\n        setTimeout(() => {\n            toastApp.unmount(); // 使用 toastApp 卸载组件\n            document.body.removeChild(mountPoint);\n            console.log(\"Toast removed from body\");\n        }, 30000);  \n    };\n\n    return {\n        showToast\n    };\n}\n\nexport default useToast;","import axios from 'axios';\nimport router from './router'\nimport useToast from './composables/useToast'\n\n\naxios.interceptors.request.use(\n    config => {\n        if (localStorage.userToken) {\n            config.headers.Authorization = localStorage.userToken;\n        }\n        return config;\n    }, error => {\n        return Promise.reject(error)\n    }\n)\n\n\naxios.interceptors.response.use(\n    response => {\n        \n        const { showToast } = useToast();\n\n        // 判断是否存在 message 并显示 toast\n        if (response.data && response.data.message) {\n            showToast(response.data.message, response.status);\n        }\n        return response\n    },\n    async error => {\n        const { showToast } = useToast()\n        console.log(\"error response:\", error.response)\n        if (error.response) {\n            const { status, data } = error.response;\n\n            // 使用后端返回的 message 或默认信息\n            const errorMessage = data.message || data.error || 'An error occurred.';\n\n            // 为特定的状态码设置特殊处理\n            if (status === 401) {\n                showToast('Token invalid. Please login again.', status,'error');\n                localStorage.removeItem('userToken');\n                router.push('/login');\n            } else {\n                // 对于其他状态码，直接显示后端返回的错误信息\n                showToast(errorMessage, status);\n            }\n        } else {\n            // 如果没有 error.response，可能是网络问题或其他问题\n            showToast('Network error. Please try again.', 'error');\n        }\n\n        return Promise.reject(error);\n    }\n);\n\n\nexport default axios","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","<template>\n  <div class=\"container-xl\">\n    <div class=\"header\">\n      <div class=\"row\">\n        <div class=\"col-xl-4 px-3\">\n          <div class=\"row\">\n            <div class=\"card\">\n              <div class=\"card-body text-center\">\n                <div class=\"mb-3\">\n                  <span class=\"avatar avatar-xl rounded\">default</span>\n                </div>\n                <div class=\"card-title mb-1\">{{ userIdentity.name }}</div>\n                <div class=\"text-muted\">{{ userIdentity.identity }}</div>\n                <div></div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"col-xl-4 px-3 d-flex align-items-center\">\n          <div class=\"row\">\n            <a\n              class=\"btn btn-secondary btn-sm\"\n              data-bs-toggle=\"modal\"\n              data-bs-target=\"#modal-team\"\n            >\n              Change Password\n            </a>\n            <div\n              class=\"modal modal-blur fade\"\n              id=\"modal-team\"\n              tabindex=\"-1\"\n              role=\"dialog\"\n              aria-hidden=\"true\"\n            >\n              <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n                <div class=\"modal-content\">\n                  <div class=\"modal-body\">\n                    <form>\n                      <fieldset class=\"form-fieldset\">\n                        <div class=\"card-header\">\n                          <h3 class=\"card-title\">Change Password</h3>\n                          <button\n                            type=\"button\"\n                            class=\"btn-close\"\n                            data-bs-dismiss=\"modal\"\n                            aria-label=\"Close\"\n                          ></button>\n                        </div>\n                        <div class=\"mb-3\">\n                          <label class=\"form-label\">New Password</label>\n                          <input\n                            type=\"text\"\n                            class=\"form-control\"\n                            placeholder=\"new password\"\n                            v-model=\"newPassword\"\n                          />\n                        </div>\n                        <div class=\"mb-3\">\n                          <label class=\"form-label\">Confrim New Password</label>\n                          <input\n                            type=\"text\"\n                            class=\"form-control\"\n                            placeholder=\"confrim new password\"\n                            v-model=\"confirmNewPassword\"\n                          />\n                        </div>\n                      </fieldset>\n                      <div class=\"card-footer text-end\">\n                        <button\n                          type=\"submit\"\n                          class=\"btn btn-primary\"\n                          @click=\"changePassword()\"\n                        >\n                          Change Password\n                        </button>\n                      </div>\n                    </form>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <a\n              class=\"btn btn-secondary btn-sm\"\n              data-bs-toggle=\"modal\"\n              data-bs-target=\"#addUser\"\n            >\n              Add User\n            </a>\n            <div\n              class=\"modal modal-blur fade\"\n              id=\"addUser\"\n              tabindex=\"-1\"\n              role=\"dialog\"\n              aria-hidden=\"true\"\n            >\n              <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n                <div class=\"modal-content\">\n                  <div class=\"modal-body\">\n                    <form\n                      @submit.prevent=\"addUser\"\n                      v-if=\"\n                        userIdentity.identity === 'Super-Admin' ||\n                        userIdentity.identity === 'PM'\n                      \"\n                    >\n                      <fieldset class=\"form-fieldset\">\n                        <div class=\"card-header\">\n                          <h3 class=\"card-title\">Add user</h3>\n                          <button\n                            type=\"button\"\n                            class=\"btn-close\"\n                            data-bs-dismiss=\"modal\"\n                            aria-label=\"Close\"\n                          ></button>\n                        </div>\n                        <div class=\"card-body\">\n                          <div class=\"mb-3\">\n                            <label class=\"form-label required\">User name</label>\n                            <div>\n                              <input\n                                type=\"name\"\n                                class=\"form-control\"\n                                placeholder=\"Enter name\"\n                                v-model=\"addUserName\"\n                                required\n                              />\n                            </div>\n                          </div>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label required\"\n                              >Email address</label\n                            >\n                            <div>\n                              <input\n                                type=\"email\"\n                                class=\"form-control\"\n                                aria-describedby=\"emailHelp\"\n                                placeholder=\"Enter email\"\n                                v-model=\"addUserEmail\"\n                                required\n                              />\n                            </div>\n                          </div>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label required\">Password</label>\n                            <div>\n                              <input\n                                type=\"password\"\n                                class=\"form-control\"\n                                placeholder=\"Password\"\n                                v-model=\"addUserPassword\"\n                                required\n                              />\n                            </div>\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\"\n                              >Sales Poc or Team-Leader</label\n                            >\n                            <div>\n                              <select\n                                class=\"form-select\"\n                                v-model=\"addUserIdentity\"\n                                required\n                              >\n                                <option>Sales</option>\n                                <option>Pod-Leader</option>\n                                <option>Team-Leader</option>\n                              </select>\n                            </div>\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">Cluster</label>\n                            <div>\n                              <select\n                                class=\"form-select\"\n                                v-model=\"addUserCluster\"\n                                required\n                              >\n                                <option>SH</option>\n                                <option>HZ</option>\n                                <option>BJ</option>\n                              </select>\n                            </div>\n                          </div>\n                        </div>\n                        <div class=\"card-footer text-end\">\n                          <button\n                            type=\"submit\"\n                            class=\"btn btn-primary\"\n                            @onclick=\"addUser\"\n                          >\n                            Add User\n                          </button>\n                        </div>\n                      </fieldset>\n                      <div class=\"card-footer text-end\"></div>\n                    </form>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"col-xl-4 px-3 d-flex align-items-center\">\n          <div class=\"row\">\n            <div class=\"row\">\n              <a\n                class=\"btn btn-secondary btn-sm custom-btn\"\n                data-bs-toggle=\"modal\"\n                data-bs-target=\"#deleteUser\"\n              >\n                Delete User\n              </a>\n              <div\n                class=\"modal modal-blur fade\"\n                id=\"deleteUser\"\n                tabindex=\"-1\"\n                role=\"dialog\"\n                aria-hidden=\"true\"\n              >\n                <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n                  <div class=\"modal-content\">\n                    <div class=\"modal-body\">\n                      <form\n                        @submit.prevent=\"deleteUser\"\n                        v-if=\"\n                          userIdentity.identity === 'Super-Admin' ||\n                          userIdentity.identity === 'PM'\n                        \"\n                      >\n                        <fieldset class=\"form-fieldset\">\n                          <div class=\"card-header\">\n                            <h3 class=\"card-title\">Delete user</h3>\n                            <button\n                              type=\"button\"\n                              class=\"btn-close\"\n                              data-bs-dismiss=\"modal\"\n                              aria-label=\"Close\"\n                            ></button>\n                          </div>\n                          <div class=\"card-body\">\n                            <div class=\"mb-3\">\n                              <label class=\"form-label\">Select Users </label>\n                              <button\n                                type=\"button\"\n                                class=\"btn-close\"\n                                data-bs-dismiss=\"modal\"\n                                aria-label=\"Close\"\n                              ></button>\n                              <div>\n                                <select\n                                  class=\"form-select\"\n                                  v-model=\"selectedDeleteUser\"\n                                >\n                                  <option disabled>Select User</option>\n                                  <option\n                                    v-for=\"user in allUsers\"\n                                    :key=\"user.id\"\n                                    :value=\"user.email\"\n                                  >\n                                    {{ user.email }}\n                                  </option>\n                                </select>\n                              </div>\n                            </div>\n                          </div>\n                          <div class=\"card-footer text-end\">\n                            <button\n                              type=\"submit\"\n                              class=\"btn btn-primary\"\n                              @onclick=\"deleteUser\"\n                            >\n                              Delete User\n                            </button>\n                          </div>\n                        </fieldset>\n                        <div class=\"card-footer text-end\"></div>\n                      </form>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <a\n                class=\"btn btn-secondary btn-sm\"\n                data-bs-toggle=\"modal\"\n                data-bs-target=\"#userAuthenticate\"\n              >\n                User authenticate\n              </a>\n              <div\n                class=\"modal modal-blur fade\"\n                id=\"userAuthenticate\"\n                tabindex=\"-1\"\n                role=\"dialog\"\n                aria-hidden=\"true\"\n              >\n                <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n                  <div class=\"modal-content\">\n                    <div class=\"modal-body\">\n                      <form\n                        @submit.prevent=\"updateUserRole\"\n                        v-if=\"\n                          userIdentity.identity === 'Super-Admin' ||\n                          userIdentity.identity === 'PM'\n                        \"\n                      >\n                        <fieldset class=\"form-fieldset\">\n                          <div class=\"card-header\">\n                            <h3 class=\"card-title\">User authenticate</h3>\n                          </div>\n                          <div class=\"card-body\">\n                            <div class=\"mb-3\">\n                              <label class=\"form-label\">Select Users </label>\n                              <button\n                                type=\"button\"\n                                class=\"btn-close\"\n                                data-bs-dismiss=\"modal\"\n                                aria-label=\"Close\"\n                              ></button>\n                              <div>\n                                <select\n                                  class=\"form-select\"\n                                  v-model=\"selectedEmail\"\n                                >\n                                  <option disabled>Select User</option>\n                                  <option\n                                    v-for=\"user in allUsers\"\n                                    :key=\"user.id\"\n                                    :value=\"user.email\"\n                                  >\n                                    {{ user.email }}\n                                  </option>\n                                </select>\n                              </div>\n                              <label class=\"form-label\">Select Role</label>\n                              <div>\n                                <select\n                                  class=\"form-select\"\n                                  v-model=\"selectedRole\"\n                                >\n                                  <option value=\"Sales\">Sales</option>\n                                  <option value=\"Pod-Leader\">\n                                    Pod-Leader/POC\n                                  </option>\n                                  <option value=\"Team-Leader\">\n                                    Team-Leader\n                                  </option>\n                                  <option value=\"Marketing_Specialist\">\n                                    Marketing_Specialist\n                                  </option>\n                                  <option value=\"BA\">BA</option>\n                                </select>\n                              </div>\n                            </div>\n                          </div>\n                          <div class=\"card-footer text-end\">\n                            <button\n                              type=\"submit\"\n                              class=\"btn btn-primary\"\n                              @onclick=\"updateUserRole\"\n                            >\n                              Change Role\n                            </button>\n                          </div>\n                        </fieldset>\n                        <div class=\"card-footer text-end\"></div>\n                      </form>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div\n            class=\"col-xl-12\"\n            v-if=\"\n              userIdentity.identity === 'Super-Admin' ||\n              userIdentity.identity === 'Team-Leader' ||\n              userIdentity.identity === 'PM'\n            \"\n          >\n            <div class=\"card\">\n              <div class=\"card-header\">\n                <h3 class=\"card-title\">Recently Requests</h3>\n              </div>\n              <div class=\"card-table table-responsive\">\n                <table class=\"table table-vcenter\">\n                  <thead>\n                    <tr>\n                      <th>Request User Name</th>\n                      <th>Request User Cluster & Title</th>\n                      <th>Request Data Description</th>\n                      <th colspan=\"2\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tr\n                    v-for=\"request in requestList\"\n                    :key=\"request._id + new Date()\"\n                  >\n                    <td>\n                      {{\n                        request.userId && request.userId.email\n                          ? request.userId.email\n                          : \"user has been delete\"\n                      }}\n                    </td>\n                    <td class=\"text-secondary\">\n                      {{\n                        request.userId && request.userId.cluster\n                          ? request.userId.cluster\n                          : \"user has been delete\"\n                      }}&{{\n                        request.userId && request.userId.identity\n                          ? request.userId.identity\n                          : \"user has been delete\"\n                      }}\n                    </td>\n                    <td class=\"text-secondary\">\n                      {{\n                        request.userId && request.userId.name\n                          ? request.userId.name\n                          : \"user has been delete\"\n                      }}申请了解{{\n                        request.partnerId\n                          ? request.partnerId.third_partner_name\n                          : \"unknown partner\"\n                      }}的{{ request.requestedContactField }}区域联系人信息\n                    </td>\n                    <td class=\"text-secondary\">\n                      <button\n                        class=\"btn btn-primary btn-sm\"\n                        style=\"\n                          --bs-btn-padding-y: 0.25rem;\n                          --bs-btn-padding-x: 0.5rem;\n                          --bs-btn-font-size: 0.75rem;\n                        \"\n                        @click=\"approveRequest(request._id)\"\n                      >\n                        approve request\n                      </button>\n\n                      <button\n                        class=\"btn btn-warning\"\n                        style=\"\n                          --bs-btn-padding-y: 0.25rem;\n                          --bs-btn-padding-x: 0.5rem;\n                          --bs-btn-font-size: 0.75rem;\n                        \"\n                        @click=\"denyRequest(request._id)\"\n                      >\n                        deny request\n                      </button>\n                    </td>\n                    <td class=\"text-end w-1\">\n                      <div\n                        class=\"chart-sparkline chart-sparkline-sm\"\n                        id=\"sparkline-bounce-rate-1\"\n                      ></div>\n                    </td>\n                  </tr>\n                </table>\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"col-xl-12\"\n            v-if=\"\n              userIdentity.identity === 'Sales' ||\n              userIdentity.identity === 'Team-Leader' ||\n              userIdentity.identity === 'POC'\n            \"\n          >\n            <div class=\"card\">\n              <div class=\"card-header\">\n                <h3 class=\"card-title\">Requests Feedback</h3>\n              </div>\n              <div class=\"card-table table-responsive\">\n                <table class=\"table table-vcenter\">\n                  <thead>\n                    <tr>\n                      <th>Request Partner Name</th>\n                      <th>Request Time</th>\n                      <th>Request Partner Description</th>\n                      <th colspan=\"2\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tr\n                    v-for=\"request in requestList\"\n                    :key=\"request._id + new Date()\"\n                  >\n                    <td>\n                      {{\n                        request.partnerId\n                          ? request.partnerId.third_partner_name\n                          : \"partner has been deleted\"\n                      }}\n                    </td>\n                    <td class=\"text-secondary\">\n                      {{ request.requestedAt }}\n                    </td>\n                    <td class=\"text-secondary\">\n                      您申请了解的{{\n                        request.requestedContactField\n                      }}的区域联系人信息，目前已被{{ request.status }}\n                    </td>\n                    <td class=\"text-secondary\">\n                      <button\n                        class=\"btn btn-warning btn-sm\"\n                        style=\"\n                          --bs-btn-padding-y: 0.25rem;\n                          --bs-btn-padding-x: 0.5rem;\n                          --bs-btn-font-size: 0.75rem;\n                        \"\n                        v-if=\"request.status === 'DENIED'\"\n                      >\n                        delete request\n                      </button>\n                      <router-link\n                        v-if=\"\n                          request.status === 'APPROVED' && request.partnerId\n                        \"\n                        class=\"btn btn-primary\"\n                        :to=\"'/single-partner/' + request.partnerId._id\"\n                        style=\"\n                          --bs-btn-padding-y: 0.25rem;\n                          --bs-btn-padding-x: 0.5rem;\n                          --bs-btn-font-size: 0.75rem;\n                        \"\n                      >\n                        view detail\n                      </router-link>\n                    </td>\n                    <td class=\"text-end w-1\">\n                      <div\n                        class=\"chart-sparkline chart-sparkline-sm\"\n                        id=\"sparkline-bounce-rate-1\"\n                      ></div>\n                    </td>\n                  </tr>\n                </table>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-xl-12\" v-if=\"userIdentity.identity === 'Super-Admin'\">\n            <div class=\"card\">\n              <div class=\"card-header\">\n                <h3 class=\"card-title\">Logs</h3>\n              </div>\n              <div class=\"card-table table-responsive\">\n                <table class=\"table table-vcenter\">\n                  <thead>\n                    <tr>\n                      <th>User</th>\n\n                      <th>Actions</th>\n                      <th>Date</th>\n                      <th>Descriptions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr v-for=\"log in logList\" :key=\"log._id + new Date()\">\n                      <td class=\"w-1\">\n                        {{\n                          log.userId && log.userId.name\n                            ? log.userId.name\n                            : \"user has been delete\"\n                        }}\n                      </td>\n                      <td class=\"td-truncate\">\n                        {{ log.action }}\n                      </td>\n                      <td class=\"text-nowrap text-secondary\">\n                        {{ log.date }}\n                      </td>\n                      <td class=\"td-truncate\">\n                        {{ log.description }}\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script setup>\nimport { ref, onMounted, computed } from \"vue\";\nimport axios from \"../http\";\nimport { useStore } from \"vuex\";\n\nconst store = useStore();\nconst userIdentity = computed(() => store.getters.user);\nconst newPassword = ref(\"\");\nconst confirmNewPassword = ref(\"\");\nconst allUsers = ref([]);\nconst selectedEmail = ref(\"\");\nconst selectedRole = ref(\"\");\nconst selectedDeleteUser = ref(\"\");\nconst updatedUserRole = ref(\"\");\nconst addUserEmail = ref(\"\");\nconst addUserPassword = ref(\"\");\nconst addUserIdentity = ref(\"\");\nconst addUserName = ref(\"\");\nconst addUserCluster = ref(\"\");\nconst requestList = ref([]);\nconst logList = ref([]);\n\nonMounted(async () => {\n  await getUsers();\n  await requestLists(userIdentity);\n  await getLogs();\n});\n\nconst getUsers = async () => {\n  try {\n    let { data } = await axios.get(\"/api/users\");\n    allUsers.value = data;\n  } catch (error) {}\n};\nconst getLogs = async () => {\n  try {\n    let { data } = await axios.get(\"/api/logs\");\n    logList.value = data;\n    console.log(logList.value);\n  } catch (error) {}\n};\nconst changePassword = () => {\n  if (newPassword.value !== confirmNewPassword.value) {\n    alert(\"password not match\");\n    return;\n  }\n  axios\n    .post(\"/api/users/edit-user/password\", {\n      newPassword: newPassword.value,\n    })\n    .then((response) => {\n      console.log(\"password update successfully \");\n    })\n    .catch((error) => {\n      console.log(\"failed to update password\");\n    });\n};\n//需要完善计算属性或重新刷新页面的问题\nconst deleteUser = async () => {\n  try {\n    await axios.delete(\"/api/users/delete/user\", {\n      data: { email: selectedDeleteUser.value },\n    });\n    await getUsers();\n    selectedDeleteUser = null;\n  } catch (error) {\n    console.log(\"error deleting user:\", error);\n  }\n};\nconst updateUserRole = async () => {\n  try {\n    await axios.put(\"/api/users/edit/role\", {\n      email: selectedEmail.value,\n      updatedUserRole: selectedRole.value,\n    });\n\n    await getUsers();\n  } catch (error) {\n    console.log(\"error editor user role:\", error);\n  }\n};\n\nconst addUser = async () => {\n  try {\n    await axios.post(\"/api/users/register\", {\n      name: addUserName.value,\n      email: addUserEmail.value,\n      password: addUserPassword.value,\n      cluster: addUserCluster.value,\n      identity: addUserIdentity.value,\n    });\n\n    await getUsers();\n  } catch (error) {\n    console.log(\"error add user \", error);\n  }\n};\n\nconst requestLists = async (userIdentity) => {\n  try {\n    if (userIdentity.value.identity === \"Super-Admin\") {\n      let { data } = await axios.get(\"/api/accessQuests/all-requests\", {\n        params: { status: \"PENDING\" },\n      });\n      requestList.value = data;\n    } else if (userIdentity.value.identity === \"PM\") {\n      let { data } = await axios.get(\"/api/accessQuests/all-requests\", {\n        params: { status: \"PENDING\" },\n      });\n      requestList.value = data;\n    } else if (\n      userIdentity.value.identity === \"Sales\" ||\n      userIdentity.value.identity === \"Team-Leader\"\n    ) {\n      let { data } = await axios.get(\n        `/api/accessQuests/user-requests/${userIdentity.value.id}`\n      );\n\n      requestList.value = data;\n    }\n  } catch (error) {\n    console.log(\"error get request list\", error);\n  }\n};\n\nconst approveRequest = async (value) => {\n  try {\n    await axios.put(\"/api/accessQuests/all-requests/\" + value, {\n      status: \"APPROVED\",\n    });\n  } catch (error) {\n    console.log(\"error approve request\", error);\n  }\n};\nconst denyRequest = async (value) => {\n  try {\n    await axios.put(\"/api/accessQuests/all-requests/\" + value, {\n      status: \"DENIED\",\n    });\n  } catch (error) {\n    console.log(\"error approve request\", error);\n  }\n};\n</script>\n<style scoped>\n@media (min-width: 1200px) {\n  .container,\n  .container-lg,\n  .container-md,\n  .container-sm,\n  .container-xl {\n    max-width: 1199px;\n  }\n}\n.table th {\n  text-align: left; /* 左对齐 */\n  font-weight: bold; /* 文字加粗 */\n}\n\n/* 表格单元格样式 */\n.table td {\n  text-align: left; /* 左对齐 */\n  vertical-align: middle; /* 垂直居中 */\n}\n\n.row {\n  padding: 0;\n}\n.col-xl-4 {\n  text-align: center;\n}\n.modal-content .btn-close {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 3.5rem;\n  height: 3.5rem;\n  margin: 0;\n  padding: 0;\n  z-index: 10;\n}\n.btn {\n  margin: 10px;\n}\n.btn-primary {\n  background-color: #216bc4;\n}\n.btn-warning {\n  background-color: #ffc107;\n}\n\n.add-new-partner {\n  background-color: #216bc4;\n  color: #f4f6fa;\n}\n.btn .icon {\n  width: 1.25rem;\n  height: 1.25rem;\n  min-width: 1.25rem;\n  margin: 0 0.5rem 0 -0.25rem;\n  vertical-align: middle;\n}\n.card {\n  box-shadow: rgba(35, 46, 60, 0.04) 0 2px 4px 0;\n  border: 1px solid rgba(101, 109, 119, 0.16);\n}\n.card {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n  word-wrap: break-word;\n  background-color: #fff;\n  background-clip: border-box;\n  border: 1px solid rgba(101, 109, 119, 0.16);\n  border-radius: 4px;\n}\n.card-body {\n  flex: 1 1 auto;\n  padding: 1rem 1rem;\n}\n.mb-3 {\n  margin-bottom: 1rem !important;\n}\n.card-title {\n  display: block;\n  margin: 0 0 1rem;\n  font-size: 1rem;\n  font-weight: 500;\n  line-height: 1.5rem;\n}\n.text-muted {\n  color: #656d77 !important;\n}\n.avatar-xl {\n  --tblr-avatar-size: 7rem;\n}\n.avatar-rounded {\n  border-radius: 100rem;\n}\n.avatar {\n  position: relative;\n  font-weight: 500;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  color: #656d77;\n  text-align: center;\n  text-transform: uppercase;\n  vertical-align: bottom;\n  background: #f0f2f6 no-repeat center/cover;\n  border-radius: 4px;\n}\n</style>\n","import script from \"./Personal.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Personal.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Personal.vue?vue&type=style&index=0&id=991c8624&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/jiandongz/Desktop/vue-partner-system/vue3-deploy/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-991c8624\"]])\n\nexport default __exports__"],"names":["isToastShowing","ref","alertClass","computed","props","statusCode","show","nextTick","toastElement","document","querySelector","toastInstance","bootstrap","Toast","value","closeToast","hide","expose","__exports__","useToast","showToast","message","console","log","mountPoint","createElement","body","appendChild","toastApp","createApp","mount","setTimeout","unmount","removeChild","axios","config","localStorage","userToken","headers","Authorization","error","Promise","reject","response","data","status","async","errorMessage","removeItem","router","exports","sfc","target","__vccOpts","key","val","store","useStore","userIdentity","getters","user","newPassword","confirmNewPassword","allUsers","selectedEmail","selectedRole","selectedDeleteUser","addUserEmail","addUserPassword","addUserIdentity","addUserName","addUserCluster","requestList","logList","onMounted","getUsers","requestLists","getLogs","changePassword","then","catch","alert","deleteUser","email","updateUserRole","updatedUserRole","addUser","name","password","cluster","identity","params","id","approveRequest","denyRequest"],"sourceRoot":""}