{"version":3,"file":"assets/js/161.24992c83.js","mappings":"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","sources":["webpack://client/./src/views/ToastComponent.vue","webpack://client/./src/views/ToastComponent.vue?3354","webpack://client/./src/composables/useToast.js","webpack://client/./src/http.js","webpack://client/./node_modules/vue-loader/dist/exportHelper.js","webpack://client/./src/views/ResetPassword.vue","webpack://client/./src/views/ResetPassword.vue?9dd8"],"sourcesContent":["<!-- MyToast.vue -->\n<template>\n  <div\n    aria-live=\"polite\"\n    aria-atomic=\"true\"\n    style=\"position: relative; min-height: 200px\"\n  >\n    <!-- Position it -->\n    <div style=\"position: absolute; top: 0; right: 0\">\n      <!-- Then put toasts within -->\n      <div\n        class=\"toast alert\"\n        :class=\"alertClass\"\n        role=\"alert\"\n        aria-live=\"assertive\"\n        aria-atomic=\"true\"\n      >\n        <div class=\"toast-header\">\n          <strong class=\"mr-auto\">{{ message }}</strong>\n          <small class=\"text-muted\">just now</small>\n          <button\n            type=\"button\"\n            class=\"ml-2 mb-1 close\"\n            data-dismiss=\"toast\"\n            @click=\"closeToast\"\n            aria-label=\"Close\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n        <!-- <div class=\"toast-body\">\n        See? Just like this.\n      </div> -->\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, defineProps, computed, nextTick } from \"vue\";\n\nconst isToastShowing = ref(false);\n\nconst props = defineProps({\n  message: {\n    type: String,\n    default: \"\",\n  },\n  statusCode: {\n    type: Number,\n    default: 200,\n  },\n});\n\nconst alertClass = computed(() => {\n  switch (props.statusCode) {\n    case 200:\n      return \"alert-success\";\n    case 400:\n      return \"alert-warning\"; // 或者你可以定义自己的灰色 alert 样式\n    case 403:\n      return \"alert-secondary\";\n    case 404:\n      return \"alert-danger\";\n    case 500:\n      return \"alert-danger\";\n    default:\n      return \"alert-primary\"; // 默认颜色\n  }\n});\nconst show = () => {\n  nextTick(() => {\n    let toastElement = document.querySelector(\".toast\");\n    let toastInstance = new bootstrap.Toast(toastElement);\n    toastInstance.show();\n    isToastShowing.value = true;\n  });\n};\nconst closeToast = () => {\n  let toastElement = document.querySelector(\".toast\");\n  let toastInstance = new bootstrap.Toast(toastElement);\n  toastInstance.hide();\n  isToastShowing.value = false;\n};\n\ndefineExpose({ show, closeToast });\n</script>\n\n<style scoped>\n.toast {\n  position: fixed;\n  top: 5%;\n  right: 5%;\n  z-index: 99999;\n  padding: 1rem;\n}\ndiv.toast.alert-success {\n  color: var(--bs-success-text);\n  background-color: var(--bs-success-bg-subtle);\n  border-color: var(--bs-success-border-subtle);\n}\ndiv.toast.alert-warning {\n  color: var(--bs-warning-text);\n  background-color: var(--bs-warning-bg-subtle);\n  border-color: var(--bs-warning-border-subtle);\n}\ndiv.toast.alert-secondary {\n  color: var(--bs-dark-text);\n  background-color: var(--bs-dark-bg-subtle);\n  border-color: var(--bs-dark-border-subtle);\n}\ndiv.toast.alert-danger {\n  color: var(--bs-danger-text);\n  background-color: var(--bs-danger-bg-subtle);\n  border-color: var(--bs-danger-border-subtle);\n}\n</style>","import script from \"./ToastComponent.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ToastComponent.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ToastComponent.vue?vue&type=style&index=0&id=9522ce64&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/jiandongz/Desktop/vue-partner-system/vue3-deploy/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9522ce64\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport Toast from '../views/ToastComponent.vue';\n\nfunction useToast() {\n    const showToast = (message, statusCode) => {\n        console.log(\"Inside showToast function\");\n\n        // 创建一个新的 div 元素作为挂载点\n        const mountPoint = document.createElement('div');\n        document.body.appendChild(mountPoint);\n\n        // 使用 createApp 创建一个新的 Vue app 实例，并将 Toast 组件挂载到 mountPoint 上\n        const toastApp = createApp(Toast, { message, statusCode }); // 注意这里增加了statusCode\n        const toastInstance = toastApp.mount(mountPoint);\n\n        console.log(\"Toast added to body\");\n\n        // 如果 Toast 组件有 show 方法，则调用它\n        if (toastInstance && typeof toastInstance.show === 'function') {\n            toastInstance.show();\n        }\n\n        setTimeout(() => {\n            toastApp.unmount(); // 使用 toastApp 卸载组件\n            document.body.removeChild(mountPoint);\n            console.log(\"Toast removed from body\");\n        }, 30000);  \n    };\n\n    return {\n        showToast\n    };\n}\n\nexport default useToast;","import axios from 'axios';\nimport router from './router'\nimport useToast from './composables/useToast'\n\n\naxios.interceptors.request.use(\n    config => {\n        if (localStorage.userToken) {\n            config.headers.Authorization = localStorage.userToken;\n        }\n        return config;\n    }, error => {\n        return Promise.reject(error)\n    }\n)\n\n\naxios.interceptors.response.use(\n    response => {\n        \n        const { showToast } = useToast();\n\n        // 判断是否存在 message 并显示 toast\n        if (response.data && response.data.message) {\n            showToast(response.data.message, response.status);\n        }\n        return response\n    },\n    async error => {\n        const { showToast } = useToast()\n        console.log(\"error response:\", error.response)\n        if (error.response) {\n            const { status, data } = error.response;\n\n            // 使用后端返回的 message 或默认信息\n            const errorMessage = data.message || data.error || 'An error occurred.';\n\n            // 为特定的状态码设置特殊处理\n            if (status === 401) {\n                showToast('Token invalid. Please login again.', status,'error');\n                localStorage.removeItem('userToken');\n                router.push('/login');\n            } else {\n                // 对于其他状态码，直接显示后端返回的错误信息\n                showToast(errorMessage, status);\n            }\n        } else {\n            // 如果没有 error.response，可能是网络问题或其他问题\n            showToast('Network error. Please try again.', 'error');\n        }\n\n        return Promise.reject(error);\n    }\n);\n\n\nexport default axios","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","<template>\n  <div>\n    <h3>Reset Password</h3>\n    <form @submit.prevent=\"submitNewPassword\">\n      <div>\n        <label for=\"password\" class=\"form-label required\" >New Password:</label>\n        <input type=\"password\" id=\"password\" v-model=\"newPassword\" required>\n      </div>\n    \n      <button type=\"submit\" class=\"btn btn-primary\">Submit</button>\n    </form>\n    <p v-if=\"message\">{{ message }}</p >\n  </div>\n</template>\n\n<script setup>\nimport axios from \"../http\";\nimport {ref,onMounted} from 'vue'\nimport {useRoute} from \"vue-router\"\n\nconst newPassword=ref(\"\")\nconst confrimNewPassword=ref(\"\")\nconst token = ref('');\nconst route = useRoute();\nlet emailValue =ref('')\n\n\nonMounted(() => {\n  token.value = route.params.token;\n  emailValue=decodeURIComponent(route.params.email) \n});\n\nconst submitNewPassword = () => {\n  // 使用 token 和 email 提交新密码\n  console.log(\"sending token:\",token.value);\n  console.log(\"sending email:\",emailValue)\n  axios.post(`/api/users/reset-password/${token.value}`, { token: token.value, email: emailValue, newPassword:newPassword.value })\n\n    .then(response => {\n      // 处理成功响应\n    })\n    .catch(error => {\n      // 处理错误\n    });\n};\n\n</script>\n","import script from \"./ResetPassword.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ResetPassword.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["isToastShowing","ref","alertClass","computed","props","statusCode","show","nextTick","toastElement","document","querySelector","toastInstance","bootstrap","Toast","value","closeToast","hide","expose","__exports__","useToast","showToast","message","console","log","mountPoint","createElement","body","appendChild","toastApp","createApp","mount","setTimeout","unmount","removeChild","axios","config","localStorage","userToken","headers","Authorization","error","Promise","reject","response","data","status","async","errorMessage","removeItem","router","exports","sfc","target","__vccOpts","key","val","newPassword","token","route","useRoute","emailValue","onMounted","params","decodeURIComponent","email","submitNewPassword","then","catch"],"sourceRoot":""}